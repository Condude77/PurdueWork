0x0000000000000000: 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F  .#include <stdio
0x0000000000000010: 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74  .h>.#include <st
0x0000000000000020: 72 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65  ring.h>.#include
0x0000000000000030: 20 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 76 6F 69   <stdlib.h>..voi
0x0000000000000040: 64 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20  d filedump(char 
0x0000000000000050: 2A 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B  * p , int len) {
0x0000000000000060: 0A 09 69 6E 74 20 63 6F 75 6E 74 20 3D 20 31 3B  ..int count = 1;
0x0000000000000070: 0A 09 70 72 69 6E 74 66 28 22 30 78 25 30 31 36  ..printf("0x%016
0x0000000000000080: 6C 58 3A 20 22 2C 20 28 75 6E 73 69 67 6E 65 64  lX: ", (unsigned
0x0000000000000090: 20 6C 6F 6E 67 29 20 70 20 2A 20 30 29 3B 0A 20   long) p * 0);. 
0x00000000000000A0: 20 20 20 20 20 09 66 6F 72 28 69 6E 74 20 69 20       .for(int i 
0x00000000000000B0: 3D 20 30 3B 20 69 20 3C 20 6C 65 6E 2D 31 3B 20  = 0; i < len-1; 
0x00000000000000C0: 69 2B 2B 29 7B 0A 20 20 20 20 20 20 20 09 09 69  i++){.       ..i
0x00000000000000D0: 6E 74 20 63 20 3D 20 70 5B 69 5D 26 30 78 46 46  nt c = p[i]&0xFF
0x00000000000000E0: 3B 0A 20 20 20 20 20 20 20 20 09 70 72 69 6E 74  ;.        .print
0x00000000000000F0: 66 28 22 25 30 32 58 20 22 2C 20 63 29 3B 0A 09  f("%02X ", c);..
0x0000000000000100: 20 09 69 6E 74 20 6A 20 3D 20 69 2B 31 3B 0A 09   .int j = i+1;..
0x0000000000000110: 20 20 09 69 66 20 28 6A 20 25 20 31 36 20 3D 3D    .if (j % 16 ==
0x0000000000000120: 20 30 20 26 26 20 6C 65 6E 2F 31 36 20 3E 3D 20   0 && len/16 >= 
0x0000000000000130: 31 29 20 7B 0A 09 20 20 20 09 09 70 72 69 6E 74  1) {..   ..print
0x0000000000000140: 66 28 22 25 31 63 22 2C 20 27 20 27 29 3B 0A 09  f("%1c", ' ');..
0x0000000000000150: 20 09 09 66 6F 72 28 69 6E 74 20 6B 20 3D 20 30   ..for(int k = 0
0x0000000000000160: 3B 20 6B 20 3C 20 31 36 20 26 26 20 6A 20 3C 20  ; k < 16 && j < 
0x0000000000000170: 31 37 3B 20 6B 2B 2B 29 7B 0A 09 20 20 20 20 20  17; k++){..     
0x0000000000000180: 09 09 09 69 6E 74 20 63 20 3D 20 70 5B 6B 5D 26  ...int c = p[k]&
0x0000000000000190: 30 78 46 46 3B 0A 09 09 20 09 09 70 72 69 6E 74  0xFF;... ..print
0x00000000000001A0: 66 28 22 25 63 22 2C 20 28 63 3E 3D 33 32 26 26  f("%c", (c>=32&&
0x00000000000001B0: 63 3C 31 32 37 29 3F 63 3A 27 2E 27 29 3B 0A 09  c<127)?c:'.');..
0x00000000000001C0: 09 20 20 20 09 7D 0A 09 09 20 20 20 20 09 66 6F  .   .}...    .fo
0x00000000000001D0: 72 28 69 6E 74 20 6B 20 3D 20 6A 20 2D 20 31 36  r(int k = j - 16
0x00000000000001E0: 3B 20 6B 20 3C 20 6A 20 26 26 20 6A 20 3E 3D 20  ; k < j && j >= 
0x00000000000001F0: 31 37 3B 20 6B 2B 2B 29 7B 0A 09 09 20 20 20 20  17; k++){...    
0x0000000000000200: 20 09 09 69 6E 74 20 63 20 3D 20 70 5B 6B 5D 26   ..int c = p[k]&
0x0000000000000210: 30 78 46 46 3B 0A 09 09 20 20 20 20 20 20 09 09  0xFF;...      ..
0x0000000000000220: 70 72 69 6E 74 66 28 22 25 63 22 2C 20 28 63 3E  printf("%c", (c>
0x0000000000000230: 3D 33 32 26 26 63 3C 31 32 37 29 3F 63 3A 27 2E  =32&&c<127)?c:'.
0x0000000000000240: 27 29 3B 0A 09 09 20 20 20 20 20 20 20 09 7D 0A  ');...       .}.
0x0000000000000250: 09 09 20 20 20 20 20 20 20 20 70 72 69 6E 74 66  ..        printf
0x0000000000000260: 28 22 5C 6E 22 29 3B 0A 09 09 09 70 72 69 6E 74  ("\n");....print
0x0000000000000270: 66 28 22 30 78 25 30 31 36 6C 58 3A 20 22 2C 20  f("0x%016lX: ", 
0x0000000000000280: 28 75 6E 73 69 67 6E 65 64 20 6C 6F 6E 67 29 20  (unsigned long) 
0x0000000000000290: 70 20 2A 20 30 20 2B 28 30 78 31 30 2A 63 6F 75  p * 0 +(0x10*cou
0x00000000000002A0: 6E 74 2B 2B 29 29 3B 0A 09 09 7D 0A 09 7D 0A 09  nt++));...}..}..
0x00000000000002B0: 69 6E 74 20 63 20 3D 20 70 5B 6C 65 6E 20 2D 20  int c = p[len - 
0x00000000000002C0: 31 5D 26 30 78 46 46 3B 0A 09 70 72 69 6E 74 66  1]&0xFF;..printf
0x00000000000002D0: 28 22 25 30 32 58 20 22 2C 20 63 29 3B 0A 09 70  ("%02X ", c);..p
0x00000000000002E0: 72 69 6E 74 66 28 22 25 31 63 22 2C 20 27 20 27  rintf("%1c", ' '
0x00000000000002F0: 29 3B 0A 09 69 66 28 6C 65 6E 20 25 20 31 36 20  );..if(len % 16 
0x0000000000000300: 3D 3D 20 30 29 7B 0A 09 09 66 6F 72 28 69 6E 74  == 0){...for(int
0x0000000000000310: 20 69 20 3D 20 6C 65 6E 2D 31 36 3B 20 69 20 3C   i = len-16; i <
0x0000000000000320: 20 6C 65 6E 3B 20 69 2B 2B 29 7B 0A 09 20 20 20   len; i++){..   
0x0000000000000330: 20 20 09 09 69 6E 74 20 63 20 3D 20 70 5B 69 5D    ..int c = p[i]
0x0000000000000340: 26 30 78 46 46 3B 0A 09 20 20 20 20 20 20 09 09  &0xFF;..      ..
0x0000000000000350: 70 72 69 6E 74 66 28 22 25 63 22 2C 20 28 63 3E  printf("%c", (c>
0x0000000000000360: 3D 33 32 26 26 63 3C 31 32 37 29 3F 63 3A 27 2E  =32&&c<127)?c:'.
0x0000000000000370: 27 29 3B 0A 09 20 20 20 20 20 20 20 09 7D 0A 09  ');..       .}..
0x0000000000000380: 7D 65 6C 73 65 7B 0A 09 09 66 6F 72 28 69 6E 74  }else{...for(int
0x0000000000000390: 20 69 20 3D 20 30 3B 20 69 20 3C 20 31 36 20 2D   i = 0; i < 16 -
0x00000000000003A0: 20 6C 65 6E 20 25 20 31 36 3B 20 69 2B 2B 29 7B   len % 16; i++){
0x00000000000003B0: 0A 09 09 20 20 09 70 72 69 6E 74 66 28 22 25 33  ...  .printf("%3
0x00000000000003C0: 63 22 2C 20 27 20 27 29 3B 0A 09 09 7D 0A 09 09  c", ' ');...}...
0x00000000000003D0: 66 6F 72 28 69 6E 74 20 69 20 3D 20 6C 65 6E 20  for(int i = len 
0x00000000000003E0: 2D 20 28 6C 65 6E 20 25 20 31 36 29 3B 20 69 20  - (len % 16); i 
0x00000000000003F0: 3C 20 6C 65 6E 3B 20 69 2B 2B 29 7B 0A 09 09 20  < len; i++){... 
0x0000000000000400: 20 20 20 20 09 69 6E 74 20 63 20 3D 20 70 5B 69      .int c = p[i
0x0000000000000410: 5D 26 30 78 46 46 3B 0A 09 09 20 20 20 20 20 20  ]&0xFF;...      
0x0000000000000420: 09 70 72 69 6E 74 66 28 22 25 63 22 2C 20 28 63  .printf("%c", (c
0x0000000000000430: 3E 3D 33 32 26 26 63 3C 31 32 37 29 3F 63 3A 27  >=32&&c<127)?c:'
0x0000000000000440: 2E 27 29 3B 0A 09 09 7D 0A 09 7D 0A 09 70 72 69  .');...}..}..pri
0x0000000000000450: 6E 74 66 28 22 5C 6E 22 29 3B 0A 7D 0A 0A 69 6E  ntf("\n");.}..in
0x0000000000000460: 74 0A 6D 61 69 6E 28 69 6E 74 20 61 72 67 63 2C  t.main(int argc,
0x0000000000000470: 20 63 68 61 72 20 2A 2A 61 72 67 76 29 20 7B 0A   char **argv) {.
0x0000000000000480: 09 69 66 28 61 72 67 63 20 3C 20 32 29 7B 0A 09  .if(argc < 2){..
0x0000000000000490: 09 70 72 69 6E 74 66 28 22 55 73 61 67 65 3A 20  .printf("Usage: 
0x00000000000004A0: 66 69 6C 65 64 75 6D 70 20 66 69 6C 65 6E 61 6D  filedump filenam
0x00000000000004B0: 65 5C 6E 22 29 3B 0A 09 09 65 78 69 74 28 31 29  e\n");...exit(1)
0x00000000000004C0: 3B 0A 09 7D 0A 09 63 68 61 72 2A 20 66 69 6C 65  ;..}..char* file
0x00000000000004D0: 4E 61 6D 65 20 3D 20 61 72 67 76 5B 31 5D 3B 0A  Name = argv[1];.
0x00000000000004E0: 09 46 49 4C 45 2A 20 66 64 20 3D 20 66 6F 70 65  .FILE* fd = fope
0x00000000000004F0: 6E 28 66 69 6C 65 4E 61 6D 65 2C 20 22 72 22 29  n(fileName, "r")
0x0000000000000500: 3B 0A 09 69 66 28 66 64 20 3D 3D 20 4E 55 4C 4C  ;..if(fd == NULL
0x0000000000000510: 29 7B 0A 09 09 70 72 69 6E 74 66 28 22 45 72 72  ){...printf("Err
0x0000000000000520: 6F 72 20 6F 70 65 6E 69 6E 67 20 66 69 6C 65 20  or opening file 
0x0000000000000530: 5C 22 25 73 5C 22 5C 6E 22 2C 20 66 69 6C 65 4E  \"%s\"\n", fileN
0x0000000000000540: 61 6D 65 29 3B 0A 09 09 65 78 69 74 28 31 29 3B  ame);...exit(1);
0x0000000000000550: 0A 09 7D 0A 09 66 73 65 65 6B 28 66 64 2C 20 30  ..}..fseek(fd, 0
0x0000000000000560: 4C 2C 20 53 45 45 4B 5F 45 4E 44 29 3B 0A 09 69  L, SEEK_END);..i
0x0000000000000570: 6E 74 20 66 69 6C 65 53 69 7A 65 20 3D 20 66 74  nt fileSize = ft
0x0000000000000580: 65 6C 6C 28 66 64 29 3B 0A 09 66 73 65 65 6B 28  ell(fd);..fseek(
0x0000000000000590: 66 64 2C 20 30 4C 2C 20 53 45 45 4B 5F 53 45 54  fd, 0L, SEEK_SET
0x00000000000005A0: 29 3B 0A 09 63 68 61 72 20 2A 20 62 75 66 66 65  );..char * buffe
0x00000000000005B0: 72 3B 0A 09 62 75 66 66 65 72 20 3D 20 28 63 68  r;..buffer = (ch
0x00000000000005C0: 61 72 2A 29 63 61 6C 6C 6F 63 28 66 69 6C 65 53  ar*)calloc(fileS
0x00000000000005D0: 69 7A 65 2C 20 73 69 7A 65 6F 66 28 63 68 61 72  ize, sizeof(char
0x00000000000005E0: 29 29 3B 0A 09 69 66 28 62 75 66 66 65 72 20 3D  ));..if(buffer =
0x00000000000005F0: 3D 20 4E 55 4C 4C 29 7B 0A 09 09 72 65 74 75 72  = NULL){...retur
0x0000000000000600: 6E 20 31 3B 0A 09 7D 0A 09 66 72 65 61 64 28 62  n 1;..}..fread(b
0x0000000000000610: 75 66 66 65 72 2C 20 73 69 7A 65 6F 66 28 63 68  uffer, sizeof(ch
0x0000000000000620: 61 72 29 2C 20 66 69 6C 65 53 69 7A 65 2C 20 66  ar), fileSize, f
0x0000000000000630: 64 29 3B 0A 09 66 63 6C 6F 73 65 28 66 64 29 3B  d);..fclose(fd);
0x0000000000000640: 0A 09 66 69 6C 65 64 75 6D 70 28 62 75 66 66 65  ..filedump(buffe
0x0000000000000650: 72 2C 20 66 69 6C 65 53 69 7A 65 29 3B 0A 09 66  r, fileSize);..f
0x0000000000000660: 72 65 65 28 62 75 66 66 65 72 29 3B 0A 7D 0A 0A  ree(buffer);.}..
0x0000000000000670: 0A                                               .
